<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat</title>
    <link rel="stylesheet" href="..//css/main.css">
</head>

<body>
    <div class="wrapper">
        <!-- Sidebar of website -->
        <aside class="sidebar_wrapper">
            <div class="image_links">
                <a class="image_link" href="https://kun.uz" data-text="Друзья">
                    <img src="../assets/icons/Vector1.svg" alt="Vector">
                </a>
                <a class="image_link" href="#" data-text="Сообщения">
                    <img src="../assets/icons/Frame 27.svg" alt="Frame 27">
                </a>
                <a class="image_link" href="#" data-text="Друзья">
                    <img src="../assets/icons/Frame 29.svg" alt="Frame 29">
                </a>
                <a class="image_link" href="#" data-text="Друзья">
                    <img src="../assets/icons/Frame 30.svg" alt="Frame 30">
                </a>
                <a class="image_link" href="#" data-text="Друзья">
                    <img src="../assets/icons/Frame 31.svg" alt="Frame 31">
                </a>
                <a class="image_link" href="#" data-text="Друзья">
                    <img src="../assets/icons/Frame 33.svg" alt="Frame 33">
                </a>
                <a class="image_link" href="#" data-text="Друзья">
                    <img src="../assets/icons/users-alt 1.svg" alt="Users Alt">
                </a>

            </div>

        </aside>
        <!-- Main Wrapper -->
        <div class="main_wrapper">
            <header class="header">
                <div class="header_left">
                    <a href="#">
                        <img src="../assets/icons/blotem.svg" alt="Logo" class="logo">

                    </a>
                    <div class="search_box">
                        <input type="text" placeholder="Поиск">
                        <button class="search_btn">
                            <img src="../assets/images/search.png" alt="Search">
                        </button>
                    </div>
                    <nav class="nav_links">
                        <a href="#">Объявления</a>
                        <a href="#">Рейтинг</a>
                        <a href="#">Поиск</a>
                        <a href="#">Правила</a>
                    </nav>
                </div>
                <div class="header_right">
                    <div class="progress_container">
                        <span class="progress_label">Следующий уровень <strong>35 EXP</strong></span>
                        <div class="progress_bar">
                            <div class="progress_fill"></div>
                        </div>
                        <div class="progress_value"></div>
                    </div>
                    <div class="icons">
                        <img src="../assets/icons/sms.svg" alt="Notifications">
                        <div class="notification_badge">
                            <img src="../assets/icons/notif.svg" alt="Messages">
                            <div class="badge">
                                <p>25</p>
                            </div>
                        </div>
                        <img src="../assets/icons/settingss.svg" alt="Settings">
                    </div>
                    <div class="user_profile">
                        <!-- <span class="user_name">Иванов</span> -->
                        <div class="dropdown">
                            <div class="dropdown-toggle">
                                <img src="../assets/images/user.png" alt="User Avatar">
                            </div>
                            <div class="dropdown-menu">
                                <p>Иван Иванов</p>
                                <ul>
                                    <li>
                                        <img src="../assets/images/setting.svg" alt="Error">
                                        <a href="#"> Настройки</a>
                                    </li>
                                    <li>
                                        <img src="../assets/images/help.svg" alt="Error">
                                        <a href="#"> Помощь</a>
                                    </li>
                                    <li>
                                        <img src="../assets/images/layer.svg" alt="Error">
                                        <a href="#"> Выйти</a>
                                    </li>
                                </ul>
                            </div>

                        </div>
                    </div>
                </div>
            </header>
            <main class="main">
                <div class="chat-section">
                    <div class="chat-container">
                        <div class="chat-list">
                            <ul id="userList" class="user-list">

                            </ul>
                        </div>
                        <div class="chat-window">
                            <div class="chat-header">
                                <div class="img" style="display: flex; align-items: center;">
                                    <img class="right_btn" style="width: 14px; margin-right: 5px; display: none;"
                                        src="../assets/icons/right.svg" alt="left" />
                                    <img src="../assets/icons/Ellipse 7-3.svg" alt="User">
                                </div>
                                <div class="title">
                                    <div class="left">
                                        <h2 id="chatTitle">Nikita Ryzhkov</h2>
                                        <span>был(а) в сети 10 часов назад</span>
                                    </div>
                                    <div class="right">
                                        <img id="menuButton" src="../assets/icons/three_dot.svg" width="32"
                                            alt="Button">
                                        <div id="menu" class="menu">
                                            <div class="triangle">

                                            </div>
                                            <div class="item">
                                                <img src="../assets/icons/m_user.svg" alt="User">
                                                <span>Показать профиль
                                            </div>
                                            <div class="item">
                                                <img src="../assets/icons/m_sun1.svg" alt="User">
                                                <span>Очистить историю
                                                </span>
                                            </div>
                                            <div class="item">
                                                <img src="../assets/icons/m_vector.svg" alt="User">
                                                <span>Пожаловаться</span>
                                            </div>
                                            <div class="hr"></div>
                                            <div class="delete item">
                                                <img src="../assets/icons/m_delete.svg" alt="User">
                                                <span>Удалить чат</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>




                            </div>
                            <div class="chat-messages" id="chatMessages">

                            </div>
                            <div class="chat-input-container">
                                <form action="">
                                    <div class="left">
                                        <label for="" class="label">
                                            <img src="../assets/icons/file_icon.svg" alt="Attach">
                                            <img src="../assets/icons/emoje.svg" alt="Emoji">
                                        </label>
                                        <input type="text" placeholder="Написать сообщение">
                                    </div>
                                    <div class="right">
                                        <img class="send-btn" src="../assets/icons/send.svg" alt="Send">
                                    </div>
                                </form>

                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
        <script src="../js/profile/profile.js"></script>
        <script>
            const menuButton_ = document.getElementById("menuButton");
            const menu_ = document.getElementById("menu");
            const menuItems_ = document.querySelectorAll(".menu .item");
            menuButton_.addEventListener("click", function (event) {
                event.stopPropagation();
                menu_.style.display = menu.style.display === "block" ? "none" : "block";
            });
            document.addEventListener("click", function (event) {
                if (!menu_.contains(event.target) && event.target !== menuButton) {
                    menu_.style.display = "none";
                }
            });
            menuItems_.forEach(item => {
                item.addEventListener("click", function () {
                    menu.style.display = "none";
                });
            });

            const users = [
                {
                    id: 1,
                    name: "Nikita Ryzhkov",
                    time: "13:33",
                    message: "Забаню",
                    img: "../assets/icons/Ellipse 7-1.svg",
                    messages: [
                        { text: "Salom, qalesan?", sender: "received" },
                        { text: "Yaxshi, o'zingchi?", sender: "sent" }
                    ]
                },
                {
                    id: 2,
                    name: "Alex Ivanov",
                    time: "12:50",
                    message: "Ассалому алайкум!",
                    img: "../assets/icons/Ellipse 7-2.svg",
                    messages: [
                        { text: "Salom!", sender: "received" },
                        { text: "Qandaysan?", sender: "sent" }
                    ]
                },
                {
                    id: 3,
                    name: "Sergey Petrov",
                    time: "11:20",
                    message: "Hey!",
                    img: "../assets/icons/Ellipse 7-2.svg",
                    messages: [
                        { text: "Hey, what's up?", sender: "received" },
                        { text: "All good!", sender: "sent" }
                    ]
                },
                {
                    id: 4,
                    name: "Anna Smirnova",
                    time: "10:05",
                    message: "Salom!",
                    img: "../assets/icons/Ellipse 7.svg",
                    messages: [
                        { text: "Salom, qanday?", sender: "received" },
                        { text: "Yaxshi, rahmat!", sender: "sent" }
                    ]
                }
            ];

            const userList = document.getElementById("userList");
            const chatTitle = document.getElementById("chatTitle");
            const chatMessages = document.getElementById("chatMessages");
            const chatContainer = document.querySelector(".chat-container");
            const chatList = document.querySelector(".chat-list");
            const chatWindow = document.querySelector(".chat-window");
            const right = document.querySelector(".right_btn")


            // Orqaga qaytish tugmasi

            right.addEventListener("click", () => {
                chatContainer.classList.remove("chat-active");
                chatList.style.display = "block";
                chatWindow.style.display = "none";
            });


            function renderUsers() {
                userList.innerHTML = "";
                users.forEach(user => {
                    const li = document.createElement("li");
                    li.setAttribute("data-user", user.id);
                    li.innerHTML = `
            <img src="${user.img}" alt="User">
            <div class="details">
                <div class="detail">
                    <p class="name">${user.name}</p>
                    <span>${user.time}</span>
                </div>
                <div class="detail">
                    <small>${user.message}</small>
                </div>
            </div>
        `;
                    li.addEventListener("click", () => loadChat(user));
                    userList.appendChild(li);
                });
            }

            function loadChat(user) {
                chatTitle.textContent = user.name;
                chatMessages.innerHTML = "";
                user.messages.forEach(msg => {
                    const div = document.createElement("div");
                    div.classList.add("message", msg.sender);
                    div.innerHTML = `
            <div class="_div">
                
                <img src="${user.img}" alt="Avatar">
                <div class="message-content">${msg.text}</div>
            </div>
        `;
                    chatMessages.appendChild(div);
                });

                if (window.innerWidth <= 768) {
                    chatContainer.classList.add("active");
                    chatList.style.display = "none";
                    chatWindow.style.display = "flex";
                    right.style.display = "block";
                }
            }
            function handleResize() {
                if (window.innerWidth > 768) {
                    chatList.style.display = "flex";
                    chatWindow.style.display = "flex";
                    right.style.display = "none";
                } else if (!chatContainer.classList.contains("chat-active")) {
                    chatList.style.display = "block";
                    chatWindow.style.display = "none";
                }
            }
            window.addEventListener("resize", handleResize);
            handleResize();
            renderUsers();

        </script>
</body>

</html>